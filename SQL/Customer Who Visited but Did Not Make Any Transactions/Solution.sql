select customer_id, count(*) as count_no_trans from visits left join transactions using(visit_id) where transaction_id is null group by customer_id order by count_no_trans asc;